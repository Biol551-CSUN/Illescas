---
title: "Loops_Purrr_Assignment"
author: "Sandy Illescas"
date: "2023-04-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set( echo = TRUE,
  fig.path = "../Output/",
	message = FALSE,
	warning = FALSE)
```

# Load Libraries
```{r}
library(here) # loads "here" library
library(tidyverse) # loads "tidyverse" library
```

# First we will Practice Looping using Purrr package
## Finding files with a specific pattern, given a path
```{r}

HWPath<-here("Week_12", "Data", "Homework_Data") # lists all the files in that path with a specific pattern
files <- dir(path = HWPath,pattern = ".csv") #Looks for all ".csv" files
files

```

# In order to run the mean and standard deviation, we must first pre-allocate space for it
```{r}

HW_Data<-data.frame(matrix(nrow = length(files), ncol = 5)) # makes an empty dataframe that has one row for each file and 5 columns for all necessary info
colnames(HW_Data)<-c("filename","mean_temp", "mean_light", "sd_temp", "sd_light" ) # gives the dataframe column names

HW_Data
```

```{r}
raw_data<-read_csv(paste0(HWPath,"/",files[1])) # tests by reading in the first file
head(raw_data)
```
# Once we see that it works, we can loop over all files
```{r}
for (i in 1:length(files)){ # loop over 1:n the number of files
raw_data<-read_csv(paste0(HWPath,"/",files[i])) # it will read all the csv files in your given path

}
```


# Now we can find the mean and standard deviation usingn Purrr
```{r}
for (i in 1:length(files)){ # loop over 1:3 the number of files 
raw_data<-read_csv(paste0(HWPath,"/",files[i])) 

HW_Data$filename[i]<-files[i] # this allows you to include all the files in your path
HW_Data$mean_temp[i]<-mean(raw_data$Temp.C, na.rm =TRUE) # this finds the mean for temperature (Temp.C column)
HW_Data$mean_light[i]<-mean(raw_data$Intensity.lux, na.rm =TRUE) # this finds the mean for light (Intensity.lux column)
HW_Data$sd_temp[i] <- sd(raw_data$Temp.C, na.rm = TRUE) # finds the standard deviation for temperature 
HW_Data$sd_light[i] <- sd(raw_data$Intensity.lux, na.rm = TRUE) # finds standard deviation for light 
} 
HW_Data
```


# Now we can do the same thing using the Tidyverse 

```{r}
HWPath<-here("Week_12", "data", "Homework_Data") # telling it where the data is. 
files <- dir(path = HWPath,pattern = ".csv") # list all the data folder with this file path. 


files
```

# When we want to indlude the whole pathway to name, we code it as such:
```{r}
files <- dir(path = HWPath,pattern = ".csv", full.names = TRUE) # this allows us to see the whole file name with pathway SHOWS the entire path name
files
```

# Now we find the mean and standard deviation 
```{r}
data<-files %>%
  set_names()%>% # set's the id of each list to the file name
  map_df(read_csv,.id = "filename")%>% # map everything to a dataframe and put the id in a column called filename
  group_by(filename) %>%
  summarise(mean_temp = mean(Temp.C, na.rm = TRUE),# this finds the mean for temperature (Temp.C column)
            mean_light = mean(Intensity.lux, na.rm = TRUE), # this finds the mean for light (Intensity.lux column)
            sd_temp = sd(Temp.C, na.rm = TRUE), # finds the standard deviation for temperature 
            sd_light= sd(Intensity.lux, na.rm = TRUE)) # finds the standard deviation for light 
data
```

